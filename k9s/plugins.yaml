---
plugins:
  # See https://k9scli.io/topics/plugins/
  raw-logs-follow:
    shortCut: Ctrl-L
    description: logs -f
    scopes:
      - po
    command: kubectl
    background: false
    args:
      - logs
      - -f
      - $NAME
      - -n
      - $NAMESPACE
      - --context
      - $CONTEXT
      - --kubeconfig
      - $KUBECONFIG
  log-less:
    shortCut: Shift-L
    description: "logs|less"
    scopes:
      - po
    command: bash
    background: false
    args:
      - -c
      - '"$@" | bat -l log --pager="less -R"'
      - dummy-arg
      - kubectl
      - logs
      - $NAME
      - -n
      - $NAMESPACE
      - --context
      - $CONTEXT
      - --kubeconfig
      - $KUBECONFIG
  log-less-container:
    shortCut: Shift-L
    description: "logs|less"
    scopes:
      - containers
    command: bash
    background: false
    args:
      - -c
      - '"$@" | bat -l log --pager="less -R"'
      - dummy-arg
      - kubectl
      - logs
      - -c
      - $NAME
      - $POD
      - -n
      - $NAMESPACE
      - --context
      - $CONTEXT
      - --kubeconfig
      - $KUBECONFIG
  cnpg-backup:
    shortCut: b
    description: Backup
    scopes:
      - cluster
    command: bash
    confirm: true
    background: false
    args:
      - -c
      - "kubectl cnpg backup $NAME -n $NAMESPACE --context \"$CONTEXT\" 2>&1 | less -R"
  cnpg-hibernate-status:
    shortCut: h
    description: Hibernate status
    scopes:
      - cluster
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg hibernate status $NAME -n $NAMESPACE --context \"$CONTEXT\" 2>&1 | less -R"
  cnpg-hibernate:
    shortCut: Shift-H
    description: Hibernate
    confirm: true
    scopes:
      - cluster
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg hibernate on $NAME -n $NAMESPACE --context \"$CONTEXT\" 2>&1 | less -R"
  cnpg-hibernate-off:
    shortCut: Shift-H
    description: Wake up hibernated cluster in this namespace
    confirm: true
    scopes:
      - namespace
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg hibernate off $NAME -n $NAME --context \"$CONTEXT\" 2>&1 | less -R"
  cnpg-logs:
    shortCut: l
    description: Logs
    scopes:
      - cluster
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg logs cluster $NAME -f -n $NAMESPACE --context $CONTEXT"
  cnpg-logs-pretty:
    shortCut: Shift-L
    description: Logs pretty
    scopes:
      - cluster
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg logs cluster $NAME -f -n $NAMESPACE --context $CONTEXT | kubectl cnpg logs pretty"
  cnpg-psql:
    shortCut: p
    description: PSQL shell
    scopes:
      - cluster
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg psql $NAME -n $NAMESPACE --context $CONTEXT"
  cnpg-reload:
    shortCut: r
    description: Reload
    confirm: true
    scopes:
      - cluster
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg reload $NAME -n $NAMESPACE --context \"$CONTEXT\" 2>&1 | less -R"
  cnpg-restart:
    shortCut: Shift-R
    description: Restart
    confirm: true
    scopes:
      - cluster
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg restart $NAME -n $NAMESPACE --context \"$CONTEXT\" 2>&1 | less -R"
  # cnpg-status:
  #   shortCut: s
  #   description: Status
  #   scopes:
  #     - cluster
  #   command: bash
  #   background: false
  #   args:
  #     - -c
  #     - "kubectl cnpg status $NAME -n $NAMESPACE --context \"$CONTEXT\" 2>&1 | less -R"
  cnpg-status-verbose:
    shortCut: Shift-S
    description: Status (verbose)
    scopes:
      - cluster
    command: bash
    background: false
    args:
      - -c
